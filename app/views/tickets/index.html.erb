<% title "Tickets" %>

<% form_tag tickets_path, :method => :get do %>
  <%= label_tag :search %>
  <%= text_field_tag :search, params[:search] %>
  <%= submit_tag "Submit" %>
<% end %>

<table id="tickets">
  <tr>
    <th>ID</th>
    <th>New</th>
    <th>Name</th>
    <th>Category</th>
    <th>Creator</th>
    <th>Assigned to</th>
    <th>Updated at</th>
  </tr>
  <% for ticket in @tickets %>
    <tr id="ticket-<%= ticket.id %>">
      <td>#<%= ticket.id %></td>
      <td><strong><%= @current_user.new_ticket?(ticket) ? 'new' : '' %></strong></td>      
      <td><%= link_to h(ticket.name), ticket %></td>
      <td><%=h ticket.category_name %></td>
      <td><%=h ticket.user_name %></td>
      <td><%=h ticket.assignee_name %></td>      
      <td><%= time ticket.updated_at %></td>
    </tr>
  <% end %>
</table>

<p><%= link_to "Create Ticket", new_ticket_path %></p>
